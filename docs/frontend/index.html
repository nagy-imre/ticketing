<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ticket Manager</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">Ticket Manager</div>
    <div class="right">
      <span id="whoami" class="muted"></span>
      <button id="logoutBtn" class="btn btn-secondary" style="display:none;">Logout</button>
    </div>
  </header>

  <main class="container">
    <section id="loginCard" class="card">
      <h2>Login</h2>
      <p class="muted">Use the seeded demo accounts: admin/admin123, facility/facility123, cleaner/cleaner123, user/user123</p>

      <div class="grid2">
        <label>
          <span>Username</span>
          <input id="username" autocomplete="username" placeholder="admin" />
        </label>
        <label>
          <span>Password</span>
          <input id="password" type="password" autocomplete="current-password" placeholder="admin123" />
        </label>
      </div>

      <button id="loginBtn" class="btn">Login</button>
      <div id="loginError" class="error" style="display:none;"></div>
    </section>

    <section id="app" style="display:none;">
      <section class="card">
        <div class="cardHeader">
          <h2>Create ticket</h2>
          <div class="muted small">Auto-assignment is based on ticket type.</div>
        </div>

        <div class="grid2">
          <label>
            <span>Title</span>
            <input id="title" placeholder="e.g., Water leak in restroom" />
          </label>

          <label>
            <span>Ticket type</span>
            <select id="typeSelect"></select>
          </label>

          <label>
            <span>Priority</span>
            <select id="priority">
              <option>LOW</option>
              <option selected>MEDIUM</option>
              <option>HIGH</option>
              <option>URGENT</option>
            </select>
          </label>

          <label>
            <span>Floor</span>
            <select id="floor"></select>
          </label>
        </div>

        <label>
          <span>Description</span>
          <textarea id="description" rows="4" placeholder="Describe the issue..."></textarea>
        </label>

        <button id="createBtn" class="btn">Create ticket</button>
        <div id="createError" class="error" style="display:none;"></div>
      </section>

      <section class="card">
        <div class="cardHeader">
          <h2>Your visible tickets</h2>
          <div class="muted small">
            Admin sees everything. Facility/Cleaner see assigned tickets. User sees own tickets.
          </div>
        </div>

        <div class="toolbar">
          <button id="refreshBtn" class="btn btn-secondary">Refresh</button>
        </div>

        <div id="tickets" class="tickets"></div>
      </section>
    </section>
  </main>

  <!-- Edit Modal -->
  <div id="modalBackdrop" class="backdrop" style="display:none;">
    <div class="modal card">
      <div class="cardHeader">
        <h2>Edit ticket</h2>
        <button id="modalClose" class="btn btn-secondary">Close</button>
      </div>

      <div id="modalMeta" class="muted small"></div>

      <div class="grid2">
        <label>
          <span>Status</span>
          <select id="editStatus">
            <option>OPEN</option>
            <option>IN_PROGRESS</option>
            <option>CLOSED</option>
          </select>
        </label>

        <label>
          <span>Priority</span>
          <select id="editPriority">
            <option>LOW</option>
            <option>MEDIUM</option>
            <option>HIGH</option>
            <option>URGENT</option>
          </select>
        </label>

        <label>
          <span>Floor</span>
          <select id="editFloor"></select>
        </label>
      </div>

      <label>
        <span>Description</span>
        <textarea id="editDescription" rows="5"></textarea>
      </label>

      <div class="toolbar">
        <button id="saveBtn" class="btn">Save</button>
        <button id="deleteBtn" class="btn btn-danger" style="display:none;">Delete (admin)</button>
      </div>

      <div id="modalError" class="error" style="display:none;"></div>
    </div>
  </div>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
